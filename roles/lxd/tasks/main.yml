---
- name: Install LXD
  snap:
    name: lxd
    classic: yes

- name: Initialize LXD
  command: lxd init --auto

- name: Make LXD to be available over the network
  command: lxc config set core.https_address "[::]"

- name: Set password for new clients
  command: lxc config set core.trust_password ""

- name: Disable swap for Kubernetes
  command: swapoff -a

- name: Add the br_netfilter kernel module
  modprobe:
    name: br_netfilter
    state: present
