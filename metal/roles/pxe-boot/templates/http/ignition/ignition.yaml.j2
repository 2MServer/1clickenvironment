variant: fcos
version: 1.3.0

passwd:
  users:
    - name: root
      ssh_authorized_keys:
        - {{ ssh_public_key }}

storage:
  # Set hostname
  files:
    - path: /etc/hostname
      mode: 0644
      contents:
        inline: {{ hostvars[item]['inventory_hostname'] }}
    - path: /etc/NetworkManager/system-connections/{{ network_interface }}.nmconnection
      mode: 0600
      contents:
        inline: |
          [connection]
          id={{ network_interface }}
          type=ethernet
          interface-name={{ network_interface }}
          permissions=
          [ipv4]
          address1={{ hostvars[item]['ansible_host'] }}/24,{{ ansible_default_ipv4.gateway }}
          dns={{ dns_server }};
          dns-search=
          method=manual
  # Set timezone
  links:
    - path: /etc/localtime
      target: /usr/share/zoneinfo/{{ timezone }}
